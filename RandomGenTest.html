<html>
  <head>
    <title>Simple Geometry Test</title>
  </head>

  <style>
  body {margin: 0;}
  canvas {width: 100%; height: 100%;}
  </style>

  <body>
	<link rel="shortcut icon" href="#">

   
    <style>
    			body {
    				font-family: Monospace;
    				background-color: #000;
    				color: #fff;
    				margin: 0px;
    				overflow: hidden;
    			}
    			#info {
    				position: absolute;
    				top: 10px;
    				width: 100%;
    				text-align: center;
    			}
    </style>

    <div id="info">
      <p>Random Map Generation</p>
    </div>

		<script type="importmap">
			{
				"imports": {
					"three": "./build/three.module.js"
				}
			}
		</script>
		
	<script type="module">

	import * as THREE from 'three';
	import { OrbitControls } from './build/controls/OrbitControls.js';
    //create the scene
    var scene = new THREE.Scene( );

    //create the webgl renderer
    var renderer = new THREE.WebGLRenderer( );

    renderer.setSize(window.innerWidth,window.innerHeight);

    //add the renderer to the current document
    document.body.appendChild(renderer.domElement );

    var ratio = window.innerWidth/window.innerHeight;

    //create the perspective camera
    //for parameters see https://threejs.org/docs/#api/cameras/PerspectiveCamera
    var camera = new THREE.PerspectiveCamera(45,ratio,0.1,1000);
    camera.position.set(0,10,-40);

    var controls = new OrbitControls( camera, renderer.domElement );

    var tissue=null;

    //base
    var material_base = new THREE.MeshBasicMaterial();
    material_base.color=  new THREE.Color(196/255, 164/255, 132/255);
    var geometry_base = new THREE.BoxGeometry(10,1,10);
    var base = new THREE.Mesh(geometry_base, material_base);

    var bases = [];

    

    //rock 1
    var material_rock = new THREE.MeshBasicMaterial();
    material_rock.color=  new THREE.Color(144/255, 12/255, 63/255);
    var geometry_rock = new THREE.BoxGeometry(1,1,1);
    const rock = new THREE.Mesh(geometry_rock, material_rock);
    rock.position.set(-4, 1, -4);

    var rocks1 = [];

    

    //tree1
    var material_tree = new THREE.MeshBasicMaterial();
    material_tree.color=  new THREE.Color(0, 255, 0);
    var geometry_tree = new THREE.BoxGeometry(2,3,2);
    const tree = new THREE.Mesh(geometry_tree, material_tree);
    tree.position.set(-4, 2, -4);

    var trees1 = [];
    
    for (var i = 0; i < 5; i++){
      bases[i] = base.clone();
      rocks1[i] = rock;
      trees1[i] = tree;
    }

    scene.add(bases[0]);
    var addV = 10
    
    for (var i = 1; i < 5; i++){
      bases[i].position.set(bases[i].position.x + addV, 0, 0)
      addV = addV + 10
      scene.add(bases[i]);
    }

    
    scene.add(rocks1[1]);
    scene.add(trees1[1]);

    //final update loop
    var MyUpdateLoop = function ( )
    {

      controls.update();
      //call the render with the scene and the camera
      renderer.render(scene,camera);
      //finally perform a recoursive call to update again
      //this must be called because the mouse change the camera position
      requestAnimationFrame(MyUpdateLoop);
    };

    requestAnimationFrame(MyUpdateLoop);

    //this function is called when the window is resized
    var MyResize = function ( )
    {
      //get the new sizes
      var width = window.innerWidth;
      var height = window.innerHeight;
      //then update the renderer
      renderer.setSize(width,height);
      //and update the aspect ratio of the camera
      camera.aspect = width/height;
      //update the projection matrix given the new values
      camera.updateProjectionMatrix();
      //and finally render the scene again
      renderer.render(scene,camera);
    };

    //link the resize of the window to the update of the camera
    window.addEventListener( 'resize', MyResize);

    window.addEventListener('click', onMouseClick, false);
    const orgTreeX = trees1[1].position.x
    const orgTreeZ = trees1[1].position.z
    const orgRockX = rocks1[1].position.x
    const orgRockZ = rocks1[1].position.z

    var stop = False;
    function onMouseClick(event) {
      trees1[1].position.x = orgTreeX+Math.random()*8
      trees1[1].position.z = orgTreeZ+Math.random()*8
      rocks1[1].position.x = orgRockX+Math.random()*8
      rocks1[1].position.z = orgRockZ+Math.random()*8
      }
    </script>
  </body>
</html>
